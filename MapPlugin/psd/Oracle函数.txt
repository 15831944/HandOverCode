--按地图编号取得X坐标
CREATE OR REPLACE FUNCTION GetZMAPX(kcbh MAPCONFIG.考场编号%TYPE,gnssX NUMBER)
RETURN NUMBER
IS
v_XC MAPCONFIG.Xc%TYPE;
v_MAXX MAPCONFIG.Maxx%TYPE;
v_MINX MAPCONFIG.Minx%TYPE;
v_Zoomin MAPCONFIG.Zoomin%TYPE;
BEGIN
SELECT MAXX,MINX,XC,ZOOMIN into v_MAXX,v_MINX,v_XC,v_Zoomin FROM MAPCONFIG WHERE 考场编号=kcbh;
IF v_XC <>1 THEN
RETURN round(abs((gnssX-v_MAXX)*v_Zoomin));
ELSE
RETURN round(abs((gnssX-v_MINX)*v_Zoomin));
END IF;
END GetZMAPX;
--按地图编号取得Y坐标
CREATE OR REPLACE FUNCTION GetZMAPY(kcbh MAPCONFIG.考场编号%TYPE,gnssY NUMBER)
RETURN NUMBER
IS
v_YC MAPCONFIG.Yc%TYPE;
v_MAXY MAPCONFIG.Maxy%TYPE;
v_MINY MAPCONFIG.Miny%TYPE;
v_Zoomin MAPCONFIG.Zoomin%TYPE;
BEGIN
SELECT MAXY,MINY,YC,ZOOMIN into v_MAXY,v_MINY,v_YC,v_Zoomin FROM MAPCONFIG WHERE 考场编号=kcbh;
IF v_YC <>1 THEN
RETURN round(abs((gnssY-v_MAXY)*v_Zoomin));
ELSE
RETURN round(abs((gnssY-v_MINY)*v_Zoomin));
END IF;
END GetZMAPY;